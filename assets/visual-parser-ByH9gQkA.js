import{r as T,a as _}from"./utils-IfPWtw63.js";import"./bootstrap-legacy-N8hfoYcW.js";import{c as q,s as S}from"./simplify_tree-CrXtGTGF.js";import{d as s}from"./en-ByXXfKfO.js";const C=["paragraph","paragraph unit","sentence","axiom","definition","chain","adverb","chain step","chain step negation","explicit bind group","chain unit","borrowing group","erased","default","enum","enum item","compact enum item"],B=["i","u","e","r","n","freeform_content","foreign quote content","foreign quote delimiter","spelling unit"],E=["ce","cei"],F=new Map([["paragraph","box box-paragraph"],["paragraph unit","box box-paragraph-unit"],["erased","box erased"],["default","box box-sentence"],["sentence","box box-sentence"],["definition","box box-sentence"],["axiom","box box-sentence"],["arguments","box box-arguments"],["defined predicate","box box-arguments"],["chain","box box-chain"],["chain step","box box-chain-step"],["chain step negation","box box-chain-step-neg"],["explicit bind group","box box-explicit-bind-group"],["imported predicate","box box-namespaced"],["chain unit","box box-chain-unit"],["adverb","box box-chain-unit-adverb"],["foreign quote","box box-borrowing foreign-quote"],["compound","box box-compound"],["number","box box-number"],["letters","box box-letters"],["enum","box"],["compact enum item","box box-list-item"],["borrowing","box"],["freeform variable","box"],["borrowing group","box box-borrowing"],["foreign quote content","box box-not-shown foreign-quote-content"],["spelling","box box-borrowing"],["metadata","box box-metadata"],["interjection","box box-note"],["parenthetical","box box-note"]]);function h(e){return F.get(e.type)||"box box-not-shown"}function u(e){var i=document.createElement("p");return i.appendChild(document.createTextNode(e)),i.innerHTML}function M(){var e=$("#input_textarea").val();if($("#result-row").slideDown(),e.length==0){$("#parse-result-raw").html(""),$("#parse-result-tree").html(""),$("#parse-result-simplified").html(""),$("#parse-result-boxes").html(""),$("#parse-result-glossing").html("");return}try{var i=new Date().getTime();e=" "+e;var n=q.parse(e),t=new Date().getTime();$("#time-label").html("(parsing took "+(t-i)+" ms)"),n=T(n),n=_(n);var o=S(n);if(n){var r=[];p(n,r);var f=$("#parse-result-raw");D(n,f);var l=$("#parse-result-tree");G(n,l);var b=$("#parse-result-simplified");O(o,b);var w=$("#parse-result-boxes");P(o,w);var y=$("#parse-result-glossing");k(r,y)}$("#parse-result-tree-tab").html("Parse tree"),$("#parse-result-raw-tab").html("Raw tree"),$("#parse-result-simplified-tab").html("Simplified tree"),$("#parse-result-boxes-tab").html("Boxes"),$("#parse-result-glossing-tab").html("Glosses")}catch(a){if(a.name&&a.name==="SyntaxError")$("#parse-result-raw-tab").html('<span class="muted">Raw tree</span>'),c(a,e,$("#parse-result-raw")),$("#parse-result-simplified-tab").html('<span class="muted">Simplified tree</span>'),c(a,e,$("#parse-result-simplified")),$("#parse-result-tree-tab").html('<span class="muted">Parse tree</span>'),c(a,e,$("#parse-result-tree")),$("#parse-result-boxes-tab").html('<span class="muted">Boxes</span>'),c(a,e,$("#parse-result-boxes")),$("#parse-result-glossing-tab").html('<span class="muted">Glosses</span>'),c(a,e,$("#parse-result-glossing"));else throw a}}function p(e,i){if(e instanceof Array)if(e.length==2&&d(e[0])&&d(e[1]))i.push(e[1]);else for(var n in e)p(e[n],i)}function D(e,i){i.html("<pre>"+JSON.stringify(e,void 0,2)+"</pre>")}function G(e,i){i.html(m(e,0))}function m(e,i){if(i>50)return"<b>too much recursion :-(</b>";if(e===null)return"<i>(none?)</i>";if(!e)return"<i>(undefined?)</i>";if(e instanceof Array){if(e.length==0)return"<i>(empty array?)</i>";var n="";if(d(e[0])){if(n+=e[0]+":",d(e[1]))return n+=" <b>["+e[1]+"]</b>",s[e[1]]&&(n+=' <span class="translation">'+s[e[1]].gloss+"</span>"),n;n+="<ul>";for(var t in e)t!=="0"&&(n+="<li>"+m(e[t],i+1)+"</li>");return n+="</ul>",n}else{n+="<i>a list:</i>",n+="<ol>";for(var t in e)n+="<li>"+m(e[t],i+1)+"</li>";return n+="</ol>",n}}return"<i>(huh? "+e+")</i>"}function O(e,i){i.html(x(e[0],0))}function x(e,i){if(i>50)return"<b>too much recursion :-(</b>";if(e===null)return"<i>(none?)</i>";if(!e)return"<i>(undefined?)</i>";var n=e.type;if(e.word)e.type=="foreign quote content"?n+=' <b>[<span class="foreign-quote-content">'+u(e.word)+"</span>]</b>":n+=" <b>["+e.word+"]</b>",s[e.word]&&(n+=' <span class="translation">'+s[e.word].gloss+"</span>");else{n+="<ul>";for(var t in e.children)n+="<li>",n+=x(e.children[t],i+1),n+="</li>";n+="</ul>"}return n}function P(e,i){var n="";n+=g(e[0],0),i.html(n)}function g(e,i){if(i>50)return"<b>too much recursion :-(</b>";if(e===null)return"<i>(none?)</i>";if(!e)return"<i>(undefined?)</i>";var n="";if(e.word){if(n+='<div class="box box-terminal',e.css_classes!=null&&(n+=` ${e.css_classes}`),e.type=="foreign quote content"&&(n+=" foreign-quote-content"),n+='">',n+='&nbsp;<div class="tip">'+u(e.word),B.includes(e.type))return n+="</div>&nbsp;<br></div>",n;if(s[e.word]&&s[e.word].short&&(n+='<div class="tiptext">'+u(s[e.word].short)+"</div>"),n+="</div>&nbsp;<br>&nbsp;"+e.type+"&nbsp;<br>",!E.includes(e.word))if(s[e.word]){let o=s[e.word].gloss;o&&(n+='<span class="translation">&nbsp;'+u(o)+"&nbsp;</span>")}else["KI","GI","borrowing","freeform variable"].includes(e.type)?n+="":n+="...";n+="</div>"}else{n+='<div class="'+h(e),e.css_classes!=null&&(n+=` ${e.css_classes}`),n+='">';for(var t in e.children)n+=g(e.children[t],i+1);if(h(e)!=="box box-not-shown"&&!C.includes(e.type))if(e.type==="compound"){let o=[];for(var t in e.children)e.children[t].type=="borrowing"?o.push("u"+e.children[t].children[1].word):e.children[t].word&&o.push(e.children[t].word);let r="e"+v(o,1).compound;n+="<br><b>"+r+"</b>",s[r]?(n+=' = <div class="tip translation">'+s[r].gloss,s[r].short&&(n+='<div class="tiptext">'+u(s[r].short)+"</div>"),n+="&nbsp;</div>"):n+=' = <div class="tip translation">???</div>'}else n+="<br>"+e.type;n+="</div>"}return n}function c(e,i,n){var t='<div class="alert"><p><b>Syntax error</b> on line <b>'+e.line+"</b>, at column <b>"+e.column+"</b>: "+e.message+'</p><p class="error-sentence">'+A(e,i)+"</p>"+R(e)+"</div>";n.html(t)}function A(e,i){var n=i.substring(e.offset-20,e.offset),t=i.substring(e.offset+0,e.offset+20);return e.offset>20&&(n="..."+n),e.offset<i.length-20&&(t=t+"..."),n+'<span class="error-marker">&#9652;</span>'+t}function R(e){if(!e.fix)return"";var i="<p>Quick fixes:<ul>";for(var n in e.fix){var t=e.fix[n];i+="<li>",t.fixFunction?(i+="<a>",i+=t.name,i+="</a>"):i+=t.name,i+="</li>"}return i+="</ul></p>",i}function k(e,i){var n='<dl class="glosser-definition dl-horizontal">';let t=0;for(var o={},r=0;r<e.length;r++){let l=e[r];if(t==0){let b="";l=="e"&&({compound:b,skip_compound:t}=v(e,r+1)),l+=b}else t--;l=="u"?r++:s[l]&&(o[l]||(o[l]=[s[l].family,s[l].short?u(s[l].short):s[l].gloss]))}o=H(o);for(var f in o)n+="<dt>"+f+"</dt>",n+='<dd><span class="gloss-family">'+o[f][0]+"</span>"+o[f][1]+"</dd>";n+="</dl>",i.html(n)}function H(e){var i=[];for(var n in e)i.push([n,e[n]]);i.sort(function(o,r){return o[0]>r[0]});var t={};return i.forEach(function(o){t[o[0]]=o[1]}),t}function v(e,i){let n=0,t="",o=2;for(e[i]=="n"?(t+="n",o=3,n++):e[i]=="r"&&(t+="r",o=-1,n++);o!=0;){let r=e[i+n];if(r=="e"){t+=" e";break}r=="u"?(t+=" "+r+e[i+n+1],n++):t+=" "+r,n++,o--}return{compound:t,offset:n}}function d(e){return typeof e=="string"||e instanceof String}$("#input_textarea").bind("keyup",function(e){M()});
